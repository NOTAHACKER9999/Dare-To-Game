<!DOCTYPE html>
<html>
<head>
<title>YouTube Player</title>
<style>
body {
  background-color: black;
  color: white;
  font-family: sans-serif;
}

#input-panel {
  background-color: rgba(255, 0, 0, 0.8);
  padding: 20px;
  margin-bottom: 20px;
}

#youtube-link {
  width: 80%;
  padding: 10px;
  border: none;
  border-radius: 5px;
}

#overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.9);
  z-index: 1000;
}

#overlay-content {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 80%;
  height: 80%;
}

#close-button {
  position: absolute;
  top: 10px;
  right: 10px;
  color: white;
  font-size: 24px;
  cursor: pointer;
}

#youtube-iframe {
  width: 100%;
  height: 100%;
  border: none;
}

/* Style for channel link display */
#channel-iframe {
    width: 100%;
    height: 100%;
    border: none;
}

</style>
</head>
<body>

<div id="input-panel">
  <input type="text" id="youtube-link" placeholder="Type a Youtube vid or music link">
  <button onclick="loadYouTube()">Load</button>
</div>

<div id="overlay">
  <div id="overlay-content">
    <span id="close-button" onclick="closeOverlay()">X</span>
    <iframe id="youtube-iframe" allowfullscreen></iframe>
    <iframe id="channel-iframe" style="display:none;" ></iframe>
  </div>
</div>

<script>
function loadYouTube() {
  let link = document.getElementById("youtube-link").value;
    let videoId = extractVideoId(link);
    let playlistId = extractPlaylistId(link);
    let channelId = extractChannelId(link);


  if (channelId) {
        openChannelOverlay(channelId);
        return; //Prevent opening the channel like video or playlist
    }


  if (videoId) {
    openVideoOverlay(videoId);
  } else if (playlistId) {
    openPlaylistOverlay(playlistId);
  } else {
    alert("Invalid YouTube link.");
  }
}

function extractVideoId(link) {
    let videoId = null;

    //Check for regular youtube link
    let regex = /[?&]v=([^&#]*)/;
    let match = link.match(regex);
    if(match){
        videoId = match[1];
        return videoId;
    }

    //Check for youtu.be link
    regex = /youtu\.be\/([^&#]*)/;
     match = link.match(regex);
    if(match){
        videoId = match[1];
        return videoId;
    }


    // Check for music.youtube.com link
     regex = /[?&]v=([^&#&]*)/;
     match = link.match(regex);
    if(match){
        videoId = match[1];
        return videoId;
    }



    return videoId;
}

function extractPlaylistId(link) {
  let playlistId = null;
  const regex = /[?&]list=([^&#]*)/;
  const match = link.match(regex);
  if (match) {
    playlistId = match[1];
  }
  return playlistId;
}

function extractChannelId(link) {
    // Check for YouTube channel link
    const channelRegex = /youtube\.com\/channel\/([^\/]*)/;
    const channelMatch = link.match(channelRegex);

    if (channelMatch) {
        return channelMatch[1];
    }
    return null;
}

function openVideoOverlay(videoId) {
  let iframe = document.getElementById("youtube-iframe");
  iframe.src = "https://www.youtube.com/embed/" + videoId + "?autoplay=1&loop=1&playlist=" + videoId;
  document.getElementById("channel-iframe").style.display = "none"; // Ensure channel iframe is hidden.
  iframe.style.display = "block"; //Ensure video iframe is displayed
  document.getElementById("overlay").style.display = "block";
}


function openPlaylistOverlay(playlistId) {
  let iframe = document.getElementById("youtube-iframe");
  iframe.src = "https://www.youtube.com/embed/videoseries?list=" + playlistId + "&autoplay=1&loop=1";
  document.getElementById("channel-iframe").style.display = "none"; // Ensure channel iframe is hidden.
   iframe.style.display = "block"; //Ensure video iframe is displayed

  document.getElementById("overlay").style.display = "block";
}

function openChannelOverlay(channelId) {
    let channelIframe = document.getElementById("channel-iframe");
    channelIframe.src = "https://www.youtube.com/channel/" + channelId;
    channelIframe.style.display = "block"; //Show the channel Iframe
    document.getElementById("youtube-iframe").style.display = "none"; // Hide the Video Iframe

    document.getElementById("overlay").style.display = "block";
}


function closeOverlay() {
  document.getElementById("overlay").style.display = "none";
  document.getElementById("youtube-iframe").src = ""; // Stop video from playing
  document.getElementById("channel-iframe").src = "";// Stop the channel from continuing to load.
}
</script>

</body>
</html>
